package schema.window;

import static java.lang.Math.abs;
import static schema.window.Constants.*;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.Serializable;
import java.text.DecimalFormat;

import javax.swing.*;
import javax.swing.border.Border;
import javax.swing.border.EmptyBorder;
import javax.swing.border.LineBorder;

import schema.Schema;
import schema.SchemaShape;
import schema.blocks.implementation.blocks.Block;
import schema.blocks.implementation.type.Type;

public class BlockShape implements Serializable {
	private int id;
	public Block block;
	public Schema schema;
    public SchemaShape schemaShape;
    public int x;
    public int y;
    public int type;
    public JPanel shape;

	public BlockShape(int t, int x, int y, int id, Schema schema, SchemaShape schemaShape, Block block) {
	    this.block = block;
		this.id = id;
		this.schema = schema;
		this.schemaShape = schemaShape;
		this.x = x;
		this.y = y;
		this.type = t;
	}
	
<<<<<<< HEAD
=======
	public JPanel Data(int p_t, int x, int y, int idOfPort) {
		JPanel panel = new JPanel();
		panel.setBorder(new LineBorder(Color.BLACK));
    	panel.setBackground(new Color(245, 222, 179));
		panel.setLayout(null);
		
		if(p_t == 0) {
            Dimension labelSize = new Dimension(80, 80);
            Border solidBorder = BorderFactory.createLineBorder(Color.BLACK, 1);
        	panel.setBounds((x+125), (y-BLOCK_HEIGHT+55), 100, 85);
			Window.desktopPane.add(panel);
			
			/*switch (block.portsOut.get(idOfPort).getType()) {
                case WATER: {
                    System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                    System.out.println("Mass of out " + block.portsOut.get(idOfPort).getMass());
                    System.out.println("Temperature of out " + block.portsOut.get(idOfPort).getTemp());
                }
                case ALCOHOL:{
                    System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                    System.out.println("Mass of out " + block.portsOut.get(idOfPort).getMass());
                    System.out.println("Temperature of out " + block.portsOut.get(idOfPort).getTemp());
                }
                case ENERGY: {
                    System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                    System.out.println("Joule of out " + block.portsOut.get(idOfPort).getJoule());
                }
                default: {
                    System.out.println(0);
                }
            }*/
            if (block.portsOut.get(idOfPort).hasValue()) { // âàæíî ïðîâåðÿòü íàëè÷èå value ïîòîìó ÷òî èíà÷å êèäàåòñÿ îøèáêà
                System.out.println(idOfPort);
                System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                System.out.println("Mass of out " + block.portsOut.get(idOfPort).getMass());
                System.out.println("Temperature of out " + block.portsOut.get(idOfPort).getTemp());
                System.out.println("Joule of out " + block.portsOut.get(idOfPort).getJoule());
            }
            /* Output */
            /* TODO ñâåðõó âûïèñûâàþòñÿ èíôîðìàöèè è ïîðòå, íóæíî èõ êàê-òî âûïèñàòü êàê ëåéáë èëè êàê óãîäíî, ïðèìåð ñíèçó, íî îí ïî÷åìó-òî íå îòîáðàæàåòñÿ */
	        JLabel label = new JLabel();   
	        if (block.portsOut.get(idOfPort).hasValue()) {
	        	label.setText("Type: " + block.portsOut.get(idOfPort).getType().toString() + " \n"); 
	            label.setVerticalAlignment(JLabel.CENTER);
	            label.setHorizontalAlignment(JLabel.CENTER);
	            label.setPreferredSize(labelSize);
	            label.setBorder(solidBorder);
		        panel.add(label);
		        label.setBounds(0, 0, 69, 25);
	        }
//          label.setText("Type: " + block.portsOut.get(idOfPort).getType().toString() + " \n"); // ïðèñâîåíèå çíà÷åíèÿ íóæíî äåëàòü ïðè óñëîâèè íàëè÷èÿ value, êàê â ïðèìåðå ñâåðõó

	        
        }
        else {
    		panel.setBounds((x-BLOCK_WIDTH+35), (y-BLOCK_HEIGHT+55), 100, 100);
    		Window.desktopPane.add(panel);
    		
    		/*	Choice Type */
            Choice type_choice = new Choice();
            panel.add(type_choice);
            type_choice.setBounds(13, 11, 69, 25);
            type_choice.add(Type.type.WATER.toString());
            type_choice.add(Type.type.ALCOHOL.toString());
            type_choice.add(Type.type.ENERGY.toString());
            panel.setVisible(true);

            /* Input 1 */
            JFormattedTextField FirstField = new JFormattedTextField(new DecimalFormat("####.##"));
            FirstField.setToolTipText("Mass, kg");
            FirstField.setValue(0);
            FirstField.setBounds(13, 33, 70, 20);
            panel.add(FirstField);

            /* Input 2 */
            JFormattedTextField SecondField = new JFormattedTextField(new DecimalFormat("####.##"));
            SecondField.setToolTipText("Temperature, C");
            SecondField.setValue(0);
            SecondField.setBounds(13, 52, 70, 20);
            panel.add(SecondField);

            /*	Button Set	*/
            JButton set = new JButton("Set");
            set.setBorder(new EmptyBorder(0, 0, 0, 0));
            panel.setToolTipText("Add values");
            set.setBounds(13, 72, 70, 18);
            set.setBorder(new LineBorder(Color.BLACK));
            panel.setLayout(new BorderLayout());
            panel.add(set);
            set.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent arg0) {
                    String type = type_choice.getSelectedItem();
                    double mass = abs(Double.parseDouble(FirstField.getText()));
                    double temp = Double.parseDouble(SecondField.getText());
                    System.out.println("In set, mass " + mass + ", temp " + temp + ", type " + type);
                    if (!schema.setPortValue(block, Type.type.valueOf(type), idOfPort, mass, temp)) {
                    	JOptionPane.showMessageDialog(Window.frame, "This type can't be chosen");
                    }
                }
            });


        }
		/*	Close Button	*/
        JButton close = new JButton("X");
        close.setBorder(new EmptyBorder(0, 0, 0, 0));
        close.setToolTipText("Close");
        close.setBounds(87, 1, 12, 12);
        panel.add(close);
        
        close.addActionListener(new ActionListener() {
    		public void actionPerformed(ActionEvent arg0) {
    			Window.desktopPane.remove(panel);
    			Window.desktopPane.revalidate();
    			Window.desktopPane.repaint();
            }
    	});
        
        return panel; 
    }
	
>>>>>>> nina
	JPanel block_creator() {
		JPanel block;
		JLabel blockType = null;
        JPanel blockData;
        JPanel DelPan;
        GridLayout layout;
<<<<<<< HEAD

        block  = new JPanel();
        block.setBackground(new Color(255, 250, 240));
        block.setBounds(x, y, BLOCK_WIDTH, BLOCK_HEIGHT);
        this.shape = block;

        blockData = new JPanel();
        layout = new GridLayout(0,3);
        blockData.setLayout(layout);

=======
        block  = new JPanel(); 
		block.setBackground(new Color(255, 250, 240));
        block.setBounds(x, y, BLOCK_WIDTH, BLOCK_HEIGHT);
        this.shape = block;
        blockData = new JPanel();
        layout = new GridLayout(0,3);
        blockData.setLayout(layout); 
        
>>>>>>> nina
        DelPan = new JPanel();
        DelPan.setLayout(layout);

    		switch (this.type) {
    			case 0: {
    				blockType = new JLabel("Warm", JLabel.CENTER );
    				break;
    			}
<<<<<<< HEAD
    			case 1: {
=======
    			case 1: { 
>>>>>>> nina
    				blockType = new JLabel("Freeze", JLabel.CENTER );
    				break;
    			}
    			case 2: {
<<<<<<< HEAD
	    			blockType = new JLabel("Make Ice", JLabel.CENTER );
=======
	    			blockType = new JLabel("Make Ice", JLabel.CENTER ); 
>>>>>>> nina
	    			break;
	    		}
    			case 3: {
	    			blockType = new JLabel("Make Liquid", JLabel.CENTER );
	    			break;
	    		}
    			case 4 : {
<<<<<<< HEAD
	    			blockType = new JLabel("Make Gas", JLabel.CENTER );
=======
	    			blockType = new JLabel("Make Gas", JLabel.CENTER ); 
>>>>>>> nina
	    			break;
	    		}
    		}
        block.add(blockType);
        block.add(blockData);
        block.add(DelPan);
        block.setVisible(true);
<<<<<<< HEAD

=======
    		
>>>>>>> nina
    	/*	Name of the block	*/
        blockType.setFont(new Font("Verdana", 1, 14));
        blockType.setSize(BLOCK_WIDTH,BLOCK_HEIGHT);
        block.add(blockType);
        block.setBorder(new LineBorder(Color.BLACK));
        block.setLayout(new GridLayout(3, 1));
<<<<<<< HEAD

=======
        
>>>>>>> nina
        /*	Delete Button */
        JButton delete = new JButton("Delete");
        DelPan.setToolTipText("Delete Block");
        DelPan.setLayout(new BorderLayout());
        DelPan.add(delete);
<<<<<<< HEAD

=======
        
>>>>>>> nina
    	delete.addActionListener(new ActionListener() {
    		public void actionPerformed(ActionEvent arg0) {
    			Window.desktopPane.remove(block);
    			Window.desktopPane.revalidate();
    			Window.desktopPane.repaint();
                schema.removeBlock(id);
                schemaShape.removeShape(id);
            }
    	});
<<<<<<< HEAD
        if (this.type == 0 |this.type == 1){
            /*	In1 Button */

=======
        if (this.type == 0 |this.type == 1) {
            /*	In1 Button */
>>>>>>> nina
            JButton In1 = new JButton("In1");
            In1.setToolTipText("Insert Values");
            blockData.add(In1);
            In1.setFont(new Font("Source Code Pro Semibold", Font.PLAIN, 15));
            In1.setBorder(new EmptyBorder(0, 0, 0, 0));
            In1.setBorder(new LineBorder(Color.BLACK));
            In1.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent arg0) {
                    JPanel panel = Data(1, x, y, 0);
                }
            });
            /*	In2 Button */
            JButton In2 = new JButton("In2");
            In2.setToolTipText("Insert Values");
            blockData.add(In2);
            In2.setFont(new Font("Source Code Pro Semibold", Font.PLAIN, 15));
            In2.setBorder(new EmptyBorder(0, 0, 0, 0));
            In2.setBorder(new LineBorder(Color.BLACK));
            In2.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent arg0) {
                    JPanel panel = Data(1, x+105, y-25, 1);
                }
            });
            /*	Out Button */
            JButton Out = new JButton("Out");
            Out.setToolTipText("Insert Values");
            blockData.add(Out);
            Out.setFont(new Font("Source Code Pro Semibold", Font.PLAIN, 15));
            Out.setBorder(new EmptyBorder(0, 0, 0, 0));
            Out.setBorder(new LineBorder(Color.BLACK));
            Out.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent arg0) {
                    JPanel panel = Data(0, x, y, 0);

    			/*JPanel panel = new JPanel();
    			panel.setBounds((x+125), (y-BLOCK_HEIGHT+55), 100, 85);
    			panel.setBackground(new Color(245, 222, 179));
    			Window.desktopPane.add(panel);
    			panel.setLayout(null);
    	        panel.setBorder(new LineBorder(Color.BLACK));

    	        /* Output
    	        JFormattedTextField OutputField = new JFormattedTextField();
    	        OutputField.setValue(0);
    	        OutputField.setBounds(14, 40, 70, 20);
    	        panel.add(OutputField);*/
                }
            });
        } else {
            /*	In1 Button */
            JButton In1 = new JButton("In1");
            In1.setToolTipText("Insert Values");
            blockData.add(In1);
            In1.setFont(new Font("Source Code Pro Semibold", Font.PLAIN, 15));
            In1.setBorder(new EmptyBorder(0, 0, 0, 0));
            In1.setBorder(new LineBorder(Color.BLACK));
            In1.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent arg0) {
                    JPanel panel = Data(1, x, y, 0);
                }
            });

            /*	Out1 Button */
            JButton Out1 = new JButton("Out1");
            Out1.setToolTipText("Values");
            blockData.add(Out1);
            Out1.setFont(new Font("Source Code Pro Semibold", Font.PLAIN, 15));
            Out1.setBorder(new EmptyBorder(0, 0, 0, 0));
            Out1.setBorder(new LineBorder(Color.BLACK));
            Out1.addActionListener(new ActionListener() {
              public void actionPerformed(ActionEvent arg0) {
<<<<<<< HEAD
                  JPanel panel = Data(0, x, y, 0);
=======
                  JPanel panel = Data(0, x-105, y-25, 0);
>>>>>>> nina
              }
            });

            /*	Out2 Button */
            JButton Out2 = new JButton("Out2");
            Out2.setToolTipText("Values");
            blockData.add(Out2);
            Out2.setFont(new Font("Source Code Pro Semibold", Font.PLAIN, 15));
            Out2.setBorder(new EmptyBorder(0, 0, 0, 0));
            Out2.setBorder(new LineBorder(Color.BLACK));
            Out2.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent arg0) {
                    JPanel panel = Data(0, x, y, 1);
                }
            });
        }

        Movement drag = new Movement(block);
<<<<<<< HEAD

      return block;
 }

    public JPanel Data(int p_t, int x, int y, int idOfPort) {
        JPanel panel = new JPanel();

        if(p_t == 0) {
            Dimension labelSize = new Dimension(80, 80);
            Border solidBorder = BorderFactory.createLineBorder(Color.BLACK, 1);
            panel.setBounds((x+125), (y-BLOCK_HEIGHT+55), 100, 85);
            panel.setBackground(new Color(245, 222, 179));
            Window.desktopPane.add(panel);
            panel.setLayout(null);
            panel.setBorder(new LineBorder(Color.BLACK));
			/*switch (block.portsOut.get(idOfPort).getType()) {
                case WATER: {
                    System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                    System.out.println("Mass of out " + block.portsOut.get(idOfPort).getMass());
                    System.out.println("Temperature of out " + block.portsOut.get(idOfPort).getTemp());
                }
                case ALCOHOL:{
                    System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                    System.out.println("Mass of out " + block.portsOut.get(idOfPort).getMass());
                    System.out.println("Temperature of out " + block.portsOut.get(idOfPort).getTemp());
                }
                case ENERGY: {
                    System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                    System.out.println("Joule of out " + block.portsOut.get(idOfPort).getJoule());
                }
                default: {
                    System.out.println(0);
                }
            }*/
            if (block.portsOut.get(idOfPort).hasValue()) { // Ð²Ð°Ð¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ value Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð¸Ð½Ð°Ñ‡Ðµ ÐºÐ¸Ð´Ð°ÐµÑ‚ÑÑ Ð¾ÑˆÐ¸Ð±ÐºÐ°
                System.out.println(idOfPort);
                System.out.println("Type of out " + block.portsOut.get(idOfPort).getType().toString());
                System.out.println("Mass of out " + block.portsOut.get(idOfPort).getMass());
                System.out.println("Temperature of out " + block.portsOut.get(idOfPort).getTemp());
                System.out.println("Joule of out " + block.portsOut.get(idOfPort).getJoule());
            }

            /* Output */
            /* TODO ÑÐ²ÐµÑ€Ñ…Ñƒ Ð²Ñ‹Ð¿Ð¸ÑÑ‹Ð²Ð°ÑŽÑ‚ÑÑ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¸ Ð¿Ð¾Ñ€Ñ‚Ðµ, Ð½ÑƒÐ¶Ð½Ð¾ Ð¸Ñ… ÐºÐ°Ðº-Ñ‚Ð¾ Ð²Ñ‹Ð¿Ð¸ÑÐ°Ñ‚ÑŒ ÐºÐ°Ðº Ð»ÐµÐ¹Ð±Ð» Ð¸Ð»Ð¸ ÐºÐ°Ðº ÑƒÐ³Ð¾Ð´Ð½Ð¾, Ð¿Ñ€Ð¸Ð¼ÐµÑ€ ÑÐ½Ð¸Ð·Ñƒ, Ð½Ð¾ Ð¾Ð½ Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ-Ñ‚Ð¾ Ð½Ðµ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ÑÑ */
            JLabel label = new JLabel();
//            label.setText("Type: " + block.portsOut.get(idOfPort).getType().toString() + " \n"); // Ð¿Ñ€Ð¸ÑÐ²Ð¾ÐµÐ½Ð¸Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð½ÑƒÐ¶Ð½Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸ ÑƒÑÐ»Ð¾Ð²Ð¸Ð¸ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ value, ÐºÐ°Ðº Ð² Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ðµ ÑÐ²ÐµÑ€Ñ…Ñƒ
            label.setVerticalAlignment(JLabel.CENTER);
            label.setHorizontalAlignment(JLabel.CENTER);
            label.setPreferredSize(labelSize);
            label.setBorder(solidBorder);
            panel.add(label);

        }
        else {
            panel.setBounds((x-BLOCK_WIDTH+35), (y-BLOCK_HEIGHT+55), 100, 85);
            panel.setBackground(new Color(245, 222, 179));
            Window.desktopPane.add(panel);
            panel.setLayout(null);
            panel.setBorder(new LineBorder(Color.BLACK));

            /*	Choice Type */
            Choice type_choice = new Choice();
            panel.add(type_choice);
            type_choice.setBounds(14, 15, 69, 25);
            type_choice.add(Type.type.WATER.toString());
            type_choice.add(Type.type.ALCOHOL.toString());
            type_choice.add(Type.type.ENERGY.toString());
            panel.setVisible(true);

            /* Input 1 */
            JFormattedTextField FirstField = new JFormattedTextField(new DecimalFormat("####.##"));
            FirstField.setToolTipText("Mass, kg");
            FirstField.setValue(0);
            FirstField.setBounds(14, 40, 70, 20);
            panel.add(FirstField);

            /* Input 2 */
            JFormattedTextField SecondField = new JFormattedTextField(new DecimalFormat("####.##"));
            SecondField.setToolTipText("Temperature, C");
            SecondField.setValue(0);
            SecondField.setBounds(14, 60, 70, 20);
            panel.add(SecondField);

            /*	Set Button TODO Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ð¾Ñ€Ð¼ Ð²Ñ‹Ð³Ð»ÑÐ´ÐµÐ»Ð¾ */
            JButton set = new JButton("Set");
            set.setBorder(new EmptyBorder(0, 0, 0, 0));
            panel.setToolTipText("Add values");
            set.setBounds(87, 1, 12, 12);
            panel.setLayout(new BorderLayout());
            panel.add(set);
            set.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent arg0) {
                    String type = type_choice.getSelectedItem();
                    double mass = abs(Double.parseDouble(FirstField.getText()));
                    double temp = Double.parseDouble(SecondField.getText());
                    System.out.println("In set, mass " + mass + ", temp " + temp + ", type " + type);
                    if (!schema.setPortValue(block, Type.type.valueOf(type), idOfPort, mass, temp)) {
                        /* TODO Ð²ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰ÐµÐµ Ð¾ÐºÐ½Ð¾ *Ð¸Ð»Ð¸ Ñ‡Ñ‚Ð¾ ÑƒÐ³Ð¾Ð´Ð½Ð¾* Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÑŽÑ‰ÐµÐµ, Ñ‡Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ð¹ Ñ‚Ð¸Ð¿ Ð½ÐµÐ»ÑŒÐ·Ð° Ð·Ð°Ð´Ð°Ñ‚ÑŒ
                           Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð²Ñ€Ð¾Ð´Ðµ "This type can't be chosen"
                         */
                        System.out.println("Cant set this type");
                    }
                }
            });


        }
        /*	Close Button	*/
        JButton close = new JButton("X");
        close.setBorder(new EmptyBorder(0, 0, 0, 0));
        close.setToolTipText("Close");
        close.setBounds(87, 1, 12, 12);
        panel.add(close);

        close.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                Window.desktopPane.remove(panel);
                Window.desktopPane.revalidate();
                Window.desktopPane.repaint();

            }
        });

        return panel;
    }
    public int getId() {
=======
      
      return block;
 }
 public int getId() {
>>>>>>> nina
	    return this.id;
 }
}
